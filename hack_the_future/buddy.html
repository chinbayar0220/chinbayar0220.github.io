<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>”®—Ä–≥”©–¥”©–ª –≥–∞—Ä–≥–∞—Ö ‚Äî Hack the Future</title>
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Turf.js (Point-in-Polygon) -->
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
  <!-- –ò–∫–æ–Ω (heroicon) -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    /* Dropdown suggestion list */
    .suggest-item { cursor:pointer; }
    .suggest-item:hover { background:#f3f4f6; }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">
  <!-- Header -->
  <header class="bg-white shadow-sm sticky top-0 z-10">
    <div class="mx-auto max-w-5xl px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold">S</div>
        <span class="font-semibold">Shedky</span>
      </div>
      <nav class="flex items-center gap-4 text-sm">
        <a class="text-gray-600 hover:text-gray-900" href="#">Examples/Portfolio</a>
        <a class="bg-blue-600 text-white px-4 py-1.5 rounded-md hover:bg-blue-700" href="#">–ù“Ø“Ø—Ä</a>
      </nav>
    </div>
  </header>

  <!-- Card -->
  <main class="mx-auto max-w-4xl px-4 py-8">
    <div class="bg-white rounded-xl shadow-sm p-6">
      <h1 class="text-xl font-semibold mb-4">”®—Ä–≥”©–¥”©–ª –≥–∞—Ä–≥–∞—Ö</h1>

      <!-- Upload/Title block -->
      <div class="border rounded-lg p-4 mb-4">
        <div class="grid grid-cols-1 md:grid-cols-[96px_1fr] gap-4 items-start">
          <div class="w-24 h-24 rounded-lg bg-gray-100 border flex items-center justify-center text-xs text-gray-500">
            –∑—É—Ä–∞–≥
          </div>
          <div class="space-y-3">
            <div>
              <label class="block text-sm text-gray-500 mb-1">–ì–∞—Ä—á–∏–≥:</label>
              <input id="titleInput" type="text" placeholder="”®—Ä–≥”©–¥–ª–∏–π–Ω –≥–∞—Ä—á–∏–≥‚Ä¶" class="w-full border rounded-md px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm text-gray-500 mb-1">–¢–∞–π–ª–±–∞—Ä:</label>
              <textarea id="descInput" rows="3" placeholder="”®—Ä–≥”©–¥–ª–∏–π–Ω —Ç–æ–≤—á —Ç–∞–π–ª–±–∞—Ä‚Ä¶" class="w-full border rounded-md px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Location input -->
      <div class="mb-2">
        <label class="flex items-center gap-2 text-sm text-gray-600">
          <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7Zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5Z"/></svg>
          –ë–∞–π—Ä—à–∏–ª –æ—Ä—É—É–ª–∞—Ö:
        </label>
      </div>
      <div class="relative">
        <input id="geoInput" type="text" placeholder="–∂: –ë–∞—è–Ω–∑“Ø—Ä—Ö, 26-—Ä —Ö–æ—Ä–æ–æ‚Ä¶" class="w-full border rounded-md px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500" autocomplete="off">
        <!-- suggestions -->
        <div id="suggestions" class="absolute left-0 right-0 top-full mt-1 bg-white border rounded-md shadow-lg hidden max-h-60 overflow-auto z-20"></div>
      </div>

      <!-- Result box -->
      <div id="officialBox" class="min-h-28 mt-8 text-sm text-gray-700">
        <pre id="officialText" class="whitespace-pre-wrap"></pre>
      </div>

      <!-- Submit -->
      <div class="mt-6">
        <button id="submitBtn" class="bg-blue-600 text-white px-5 py-2 rounded-md hover:bg-blue-700">”®–†–ì”®–î–õ–ò–ô–ì –ò–õ–ì–≠–≠–•</button>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-10 bg-blue-600 text-white">
    <div class="mx-auto max-w-5xl px-6 py-6 grid md:grid-cols-4 gap-6 items-start">
      <div>
        <h4 class="font-semibold mb-2">–ï—Ä”©–Ω—Ö–∏–π —Ç—É—Ö–∞–π</h4>
        <p class="text-sm opacity-90">–∏—Ä–≥—ç–¥–∏–π–Ω “Ø–≥ —Å–æ–Ω—Å–æ—Ö, –∞—Å—É—É–¥–∞–ª —à–∏–π–¥–≤—ç—Ä–ª—ç—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.</p>
      </div>
      <div>
        <h4 class="font-semibold mb-2">–•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö</h4>
        <p class="text-sm opacity-90">info@shedky.mn</p>
        <p class="text-sm opacity-90">+976 8800-0000</p>
      </div>
      <div class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-full bg-white/10 flex items-center justify-center">üìç</div>
        <div class="text-sm opacity-90">–£–ª–∞–∞–Ω–±–∞–∞—Ç–∞—Ä —Ö–æ—Ç, –ú–æ–Ω–≥–æ–ª —É–ª—Å</div>
      </div>
      <div class="justify-self-end">
        <div class="bg-white p-2 rounded">
          <!-- QR demo -->
          <img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=https://shedky.mn" alt="QR">
        </div>
      </div>
    </div>
  </footer>

<script>
/* ---------- 1) Demo GeoJSON (–∂–∏—à—ç—ç) ---------- */
/* –¢–∞ —ç–Ω–¥ ”©”©—Ä–∏–π–Ω –∂–∏–Ω—Ö—ç–Ω—ç —Ö–∏–ª (—Ö–æ—Ä–æ–æ/—Å—É–º) GeoJSON-–æ–æ –æ—Ä—É—É–ª–Ω–∞. */
const BOUNDARIES_GEOJSON = {
  "type":"FeatureCollection",
  "features":[
    { "type":"Feature",
      "properties": { "admin_code":"UB-BZD-26", "admin_name":"–£–ë, –ë–∞—è–Ω–∑“Ø—Ä—Ö 26-—Ä —Ö–æ—Ä–æ–æ" },
      "geometry": { "type":"Polygon", "coordinates":[[
        [106.9400,47.9160],[106.9600,47.9160],[106.9600,47.9300],[106.9400,47.9300],[106.9400,47.9160]
      ]]}}
    ,
    { "type":"Feature",
      "properties": { "admin_code":"UB-SBD-01", "admin_name":"–£–ë, –°“Ø—Ö–±–∞–∞—Ç–∞—Ä 1-—Ä —Ö–æ—Ä–æ–æ" },
      "geometry": { "type":"Polygon", "coordinates":[[
        [106.9000,47.9100],[106.9300,47.9100],[106.9300,47.9250],[106.9000,47.9250],[106.9000,47.9100]
      ]]}},
    { "type":"Feature",
      "properties": { "admin_code":"UB-CHD-04", "admin_name":"–£–ë, –ß–∏–Ω–≥—ç–ª—Ç—ç–π 4-—Ä —Ö–æ—Ä–æ–æ" },
      "geometry": { "type":"Polygon", "coordinates":[[
        [106.8900,47.9250],[106.9150,47.9250],[106.9150,47.9400],[106.8900,47.9400],[106.8900,47.9250]
      ]]}}
  ]
};

/* ---------- 2) Officials data (–∂–∏—à—ç—ç) ---------- */
/* admin_code-–æ–æ—Ä —Ç–∞ –±–æ–¥–∏—Ç –¥–∞—Ä–≥—ã–Ω –º—ç–¥—ç—ç–ª–ª—ç—ç —Ö–æ–ª–±–æ–∂ ”©–≥–Ω”©. */
const OFFICIALS = {
  "UB-BZD-26": { leader_name:"–ß–∏–Ω–≥“Ø“Ø–Ω", title:"–• —Ö–æ—Ä–æ–æ –∑–∞—Å–∞–≥ –¥–∞—Ä–≥–∞", phone:"+976 9900-0001", email:"chingun@bzd.gov.mn" },
  "UB-SBD-01": { leader_name:"–≠–Ω—Ö-–ê–º–≥–∞–ª–∞–Ω", title:"1-—Ä —Ö–æ—Ä–æ–æ –∑–∞—Å–∞–≥ –¥–∞—Ä–≥–∞", phone:"+976 9900-0002", email:"enkh@sbd.gov.mn" },
  "UB-CHD-04": { leader_name:"–°–∞—Ä—É—É–ª", title:"4-—Ä —Ö–æ—Ä–æ–æ –∑–∞—Å–∞–≥ –¥–∞—Ä–≥–∞", phone:"+976 9900-0003", email:"saruul@chd.gov.mn" }
};

/* ---------- 3) Helper: –¥–µ–±–∞—É–Ω—Å ---------- */
function debounce(fn, ms=400){
  let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), ms); };
}

/* ---------- 4) Geocode (Nominatim, API key —à–∞–∞—Ä–¥–ª–∞–≥–∞–≥“Ø–π) ---------- */
async function geocodeQuery(q){
  if(!q || q.trim().length < 3) return [];
  const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&addressdetails=1&limit=5`;
  const r = await fetch(url, { headers: { "Accept":"application/json" } });
  if(!r.ok) return [];
  return await r.json(); // [{lat, lon, display_name}, ...]
}

/* ---------- 5) Point-in-Polygon —à–∞–ª–≥–∞–ª—Ç ---------- */
function findArea({lat, lon}){
  const pt = turf.point([parseFloat(lon), parseFloat(lat)]);
  for(const f of BOUNDARIES_GEOJSON.features){
    if(turf.booleanPointInPolygon(pt, f)) {
      const code = f.properties.admin_code;
      const area = f.properties.admin_name;
      const official = OFFICIALS[code] || null;
      return { code, area, official };
    }
  }
  return null;
}

/* ---------- 6) UI logic ---------- */
const $sugg = document.getElementById('suggestions');
const $geo  = document.getElementById('geoInput');
const $out  = document.getElementById('officialText');

async function renderSuggestions(q){
  const items = await geocodeQuery(q);
  if(!items.length){ $sugg.classList.add('hidden'); $sugg.innerHTML=''; return; }
  $sugg.innerHTML = items.map(i => `
    <div class="suggest-item px-3 py-2 text-sm" data-lat="${i.lat}" data-lon="${i.lon}">
      ${i.display_name}
    </div>`).join('');
  $sugg.classList.remove('hidden');
}

$geo.addEventListener('input', debounce(e => renderSuggestions(e.target.value), 350));

$sugg.addEventListener('click', (e)=>{
  const item = e.target.closest('.suggest-item');
  if(!item) return;
  const lat = item.getAttribute('data-lat');
  const lon = item.getAttribute('data-lon');
  $geo.value = item.textContent.trim();
  $sugg.classList.add('hidden');

  const match = findArea({lat, lon});
  if(match && match.official){
    const o = match.official;
    $out.textContent =
`–¢–∞–Ω—ã ”©—Ä–≥”©–¥”©–ª —Ö–∞–∞–Ω–∞ –æ—á–∏—Ö –≤—ç:
–•–∞—Ä–∏—É—Ü–∞—Ö –Ω—ç–≥–∂: ${match.area}
–ê–ª–±–∞–Ω —Ç—É—à–∞–∞–ª: ${o.title}
–ù—ç—Ä: ${o.leader_name}
–£—Ç–∞—Å: ${o.phone}
–ò-–º—ç–π–ª: ${o.email}`;
  } else if (match && !match.official) {
    $out.textContent = `–•–∞—Ä—å—è–∞–ª–∞–ª —Ç–æ–¥–æ—Ä–ª–æ–æ: ${match.area}
–ì—ç—Ö–¥—ç—ç –¥–∞—Ä–≥—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª –±“Ø—Ä—Ç–≥—ç–ª–≥“Ø–π –±–∞–π–Ω–∞. –ê–¥–º–∏–Ω—Ç–∞–π —Ö–æ–ª–±–æ–æ –±–∞—Ä–∏–Ω–∞ —É—É.`;
  } else {
    $out.textContent = '–û—Ä—É—É–ª—Å–∞–Ω –±–∞–π—Ä—à–∏–ª –º–∞–Ω–∞–π —Ö–∏–ª–∏–π–Ω –¥–∞—Ç–∞–∞—Å –æ–ª–¥—Å–æ–Ω–≥“Ø–π. –î–∞—Ö–∏–Ω —Ç–æ–¥—Ä—É—É–ª–∂ —Ö–∞–π–Ω–∞ —É—É.';
  }
});

/* Submit –¥–µ–º–æ */
document.getElementById('submitBtn').addEventListener('click', ()=>{
  alert('”®—Ä–≥”©–¥”©–ª –∏–ª–≥—ç—ç–≥–¥–ª—ç—ç (–¥–µ–º–æ). –¢–∞ backend/API —Ö–æ–ª–±–æ–∂ –±–æ–¥–∏—Ç–æ–æ—Ä —Ö–∞–¥–≥–∞–ª–Ω–∞.');
});
</script>
</body>
</html>
